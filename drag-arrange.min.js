(function(c){"function"===typeof define&&define.amd?define(["jquery"],c):c(jQuery)})(function(c){c.fn.dragArrange=function(k,D){function E(){for(var a=k.split(" "),b=[],c=0;c<a.length;c++)if(t.is(a[c]))b.push(a[c]);else break;a=b.join(" ");return k.replace(a,"").trim()}function F(a){v=!0;m=c(k);a.stopPropagation();c(window).add(document).on("mousemove touchmove",y);a=z(a);A=a.x;B=u=a.y;q=h.dragSelector?c(this).parents(k)[0]:this;d=c(q);C()}function z(a){return a.pageX?{x:a.pageX,y:a.pageY}:{x:a.clientX||
a.originalEvent.touches[0].clientX,y:(a.clientY||a.originalEvent.touches[0].clientY)+c(document).scrollTop()}}function y(){return!1}function G(a){if(v){d.css("touch-action","none");var b=z(a),f=b.x-A,e=b.y-B;if(r){a.stopPropagation();l.css({left:w+f,top:x+e});u=b.y;a=t.offset().top;b=c(document).scrollTop();f=t.outerHeight();f=a+f;e=c(window).height();if(r&&!(a>b&&f<e+b)){var g=d.outerHeight(),g=Math.min(g,e/4);u<b+g&&b>a&&c(document).scrollTop(b-h.scrollSpeed);u>b+e-g&&f>b+e&&c(document).scrollTop(b+
h.scrollSpeed)}a:{e=l.offset();b=l.width();g=l.height();a=e.left;for(var b=e.left+b,f=e.top,e=e.top+g,p,n,k=0;k<m.length;k++)if(g=m.eq(k),g[0]!==d[0]&&(n=g.offset(),p=n.left+.5*g.width(),n=n.top+.5*g.height(),p=p<b&&p>a,n=n<e&&n>f,p=p&&n)){b=g[0];break a}b=void 0}b!==d[0]&&(a=m.index(b),f=m.index(d),a<f?c(b).before(d):c(b).after(d),b=m.splice(f,1)[0],m.splice(a,0,b))}else(5<Math.abs(f)||5<Math.abs(e))&&C()}}function C(){var a=d;l=a.clone();l.css({position:"absolute",width:a.width(),height:a.height(),
"z-index":1E5}).addClass(h.cssPrefix+"dragging");w=q.offsetLeft-parseInt(d.css("margin-left"))-parseInt(d.css("padding-left"));x=q.offsetTop-parseInt(d.css("margin-top"))-parseInt(d.css("padding-top"));l.css({left:w,top:x});d.parent().append(l);d.css("visibility","hidden");r=!0}function H(a){r&&(a.stopPropagation(),r=!1,l.remove(),q.style.visibility="visible");c(window).add(document).off("mousemove touchmove",y);v=!1}if(k){var h={cssPrefix:"",containerSelector:"",scrollSpeed:20},h=c.extend(h,D),r=
!1,l,q,d,A,B,u,v=!1,w,x,m=this,t=h.containerSelector?c(h.containerSelector):c(m[0]).parent(),I=h.dragSelector?h.dragSelector:E();t.on("mousedown touchstart",I,F);c(document).add(window).on("mousemove touchmove",G).on("mouseup touchend",H)}else console.log("Cannot initialize arrangeable without drag elements selector specified!")}});
