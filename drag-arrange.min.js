(function(b){"function"===typeof define&&define.amd?define(["jquery"],b):b(jQuery)})(function(b){b.fn.dragArrange=function(r,C){function D(){for(var a=r.split(" "),c=[],b=0;b<a.length;b++)if(v.is(a[b]))c.push(a[b]);else break;a=c.join(" ");return r.replace(a,"").trim()}function E(a){w=!0;l=b(r);a.stopPropagation();b(window).add(document).on("mousemove touchmove",z);A=a.pageX;B=p=a.pageY;t=h.dragSelector?b(this).parents(r)[0]:this;e=b(t)}function z(){return!1}function F(a){if(w){e.css("touch-action",
"none");var c=a.pageX-A,g=a.pageY-B;if(u){a.stopPropagation();k.css({left:x+c,top:y+g});p=a.pageY;c=v.outerHeight();a=v.offset().top;var c=a+c,g=b(window).height(),d=b(document).scrollTop(),f=e.outerHeight(),m=1;!u||a>d&&c<g+d||(p>d&&p<d+f&&d>a&&(m=(f+d-p)/f,a=m*h.scrollSpeed,b(document).scrollTop(d-a)),p>d+g-f&&c>d+g&&(m=(d+g-p)/f,b(document).scrollTop(d+h.scrollSpeed*m)));a:{d=k.offset();c=k.width();f=k.height();a=d.left;for(var c=d.left+c,g=d.top,d=d.top+f,q,n,m=0;m<l.length;m++)if(f=l.eq(m),f[0]!==
e[0]&&(n=f.offset(),q=n.left+.5*f.width(),n=n.top+.5*f.height(),q=q<c&&q>a,n=n<d&&n>g,q=q&&n)){c=f[0];break a}c=void 0}c!==e[0]&&(a=l.index(c),g=l.index(e),a<g?b(c).before(e):b(c).after(e),c=l.splice(g,1)[0],l.splice(a,0,c))}else if(5<Math.abs(c)||5<Math.abs(g))a=e,k=a.clone(),k.css({position:"absolute",width:a.width(),height:a.height(),"z-index":1E5}).addClass(h.cssPrefix+"dragging"),x=t.offsetLeft-parseInt(e.css("margin-left"))-parseInt(e.css("padding-left")),y=t.offsetTop-parseInt(e.css("margin-top"))-
parseInt(e.css("padding-top")),k.css({left:x,top:y}),e.parent().append(k),e.css("visibility","hidden"),u=!0}}function G(a){u&&(a.stopPropagation(),u=!1,k.remove(),t.style.visibility="visible",b(window).add(document).off("mousemove touchmove",z));w=!1}if(r){var h={cssPrefix:"",containerSelector:"",scrollSpeed:20},h=b.extend(h,C),u=!1,k,t,e,A,B,p,w=!1,x,y,l=this,v=h.containerSelector?b(h.containerSelector):b(l[0]).parent(),H=h.dragSelector?h.dragSelector:D();v.on("mousedown touchstart",H,E);b(document).on("mousemove touchmove",
F).on("mouseup touchend",G)}else console.log("Cannot initialize arrangeable without drag elements selector specified!")}});
